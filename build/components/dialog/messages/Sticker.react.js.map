{"version":3,"sources":["../../../../src/components/dialog/messages/Sticker.react.js"],"names":[],"mappings":";;;;AAIA;;;;AACA;;;;;;;;;;;;;;AAEA,IAAI,QAAQ,EAAR;;;;;;IAKE;;;AAQJ,WARI,OAQJ,CAAY,KAAZ,EAAmB;0BARf,SAQe;;iDACjB,sBAAM,KAAN,GADiB;;UAQnB,SAAS,YAAM;AACb,YAAK,SAAL,GADa;AAEb,UAAI,CAAC,MAAK,KAAL,CAAW,QAAX,EAAqB;AACxB,cAAK,QAAL,CAAc,EAAC,UAAU,IAAV,EAAf,EADwB;OAA1B;KAFO,CARU;;UAenB,WAAW;aAAM,MAAM,MAAK,KAAL,CAAW,OAAX,CAAN,KAA8B,IAA9B;KAAN,CAfQ;;UAiBnB,YAAY;aAAM,MAAM,MAAK,KAAL,CAAW,OAAX,CAAN,GAA4B,IAA5B;KAAN,CAjBO;;AAGjB,UAAK,KAAL,GAAa;AACX,gBAAU,MAAK,QAAL,EAAV;KADF,CAHiB;;GAAnB;;AARI,oBA2BJ,2BAAS;iBAC6B,KAAK,KAAL,CAD7B;QACC,6BADD;QACY,aADZ;QACe,aADf;QACkB,yBADlB;QAEC,WAAa,KAAK,KAAL,CAAb,SAFD;;AAGP,QAAM,YAAY;;QAAK,WAAU,WAAV,EAAL;MAA2B,0CAA3B;MAAiC,0CAAjC;MAAuC,0CAAvC;MAA6C,0CAA7C;MAAmD,0CAAnD;KAAZ,CAHC;AAIP,QAAM,mBAAmB,0BAAW,SAAX,EAAsB;AAC7C,yBAAmB,QAAnB;KADuB,CAAnB,CAJC;;AAQP,QAAM,YAAY,GAAZ,CARC;AASP,QAAM,aAAa,GAAb,CATC;AAUP,QAAI,QAAQ,CAAR,CAVG;AAWP,QAAI,SAAS,CAAT,CAXG;;AAaP,QAAI,QAAQ,MAAR,EAAgB;AAClB,UAAI,QAAQ,SAAR,EAAmB;AACrB,kBAAU,YAAY,KAAZ,CADW;AAErB,gBAAQ,SAAR,CAFqB;OAAvB;KADF,MAKO;AACL,UAAI,SAAS,UAAT,EAAqB;AACvB,iBAAS,aAAa,MAAb,CADc;AAEvB,iBAAS,UAAT,CAFuB;OAAzB;KANF;;AAYA,WACE;;QAAK,WAAW,SAAX,EAAL;MACE;;UAAK,WAAW,gBAAX,EAA6B,OAAO,EAAC,YAAD,EAAQ,cAAR,EAAP,EAAlC;QACG,SADH;QAEE,uCAAK,KAAK,OAAL;AACA,iBAAO,KAAP;AACA,kBAAQ,MAAR;AACA,kBAAQ,KAAK,MAAL,EAHb,CAFF;OADF;KADF,CAzBO;;;SA3BL;;;QACG,YAAY;AACjB,aAAW,iBAAU,MAAV;AACX,WAAS,iBAAU,MAAV;AACT,KAAG,iBAAU,MAAV,CAAiB,UAAjB;AACH,KAAG,iBAAU,MAAV,CAAiB,UAAjB;;kBA6DQ","file":"Sticker.react.js","sourcesContent":["/*\n * Copyright (C) 2015 Actor LLC. <https://actor.im>\n */\n\nimport React, { Component, PropTypes } from 'react';\nimport classnames from 'classnames';\n\nlet cache = {};\n\n/**\n * Class that represents a component for display sticker message content\n */\nclass Sticker extends Component {\n  static propTypes = {\n    className: PropTypes.string,\n    fileUrl: PropTypes.string,\n    h: PropTypes.number.isRequired,\n    w: PropTypes.number.isRequired\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      isLoaded: this.isCached()\n    }\n  }\n\n  onLoad = () => {\n    this.setCached();\n    if (!this.state.isLoaded) {\n      this.setState({isLoaded: true});\n    }\n  };\n\n  isCached = () => cache[this.props.fileUrl] === true;\n\n  setCached = () => cache[this.props.fileUrl] = true;\n\n  render() {\n    const { className, w, h, fileUrl} = this.props;\n    const { isLoaded } = this.state;\n    const preloader = <div className=\"preloader\"><div/><div/><div/><div/><div/></div>;\n    const stickerClassName = classnames('sticker', {\n      'sticker--loaded': isLoaded\n    });\n\n    const MAX_WIDTH = 200;\n    const MAX_HEIGHT = 200;\n    let width = w;\n    let height = h;\n\n    if (width > height) {\n      if (width > MAX_WIDTH) {\n        height *= MAX_WIDTH / width;\n        width = MAX_WIDTH;\n      }\n    } else {\n      if (height > MAX_HEIGHT) {\n        width *= MAX_HEIGHT / height;\n        height = MAX_HEIGHT;\n      }\n    }\n\n    return (\n      <div className={className}>\n        <div className={stickerClassName} style={{width, height}}>\n          {preloader}\n          <img src={fileUrl}\n               width={width}\n               height={height}\n               onLoad={this.onLoad}/>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Sticker;\n"]}