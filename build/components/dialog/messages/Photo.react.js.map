{"version":3,"sources":["../../../../src/components/dialog/messages/Photo.react.js"],"names":[],"mappings":";;;;AAIA;;;;AACA;;;;AAEA;;;;;;;;;;;;AAEA,IAAI,QAAQ,EAAR;;;;;;;IAME;;;AAOJ,WAPI,KAOJ,CAAY,KAAZ,EAAmB;0BAPf,OAOe;;iDACjB,sBAAM,KAAN,GADiB;;UAQnB,eAAe;aAAM,qBAAS,IAAT,CAAc,MAAK,KAAL,CAAW,OAAX,CAAmB,OAAnB,EAA4B,SAA1C;KAAN,CARI;;UAUnB,SAAS,YAAM;AACb,YAAK,SAAL,GADa;AAEb,UAAI,CAAC,MAAK,KAAL,CAAW,aAAX,EAA0B;AAC7B,cAAK,QAAL,CAAc,EAAC,eAAe,IAAf,EAAf,EAD6B;OAA/B;KAFO,CAVU;;UAiBnB,WAAW;aAAM,MAAM,MAAK,KAAL,CAAW,OAAX,CAAmB,OAAnB,CAAN,KAAsC,IAAtC;KAAN,CAjBQ;;UAmBnB,YAAY,YAAM;AAChB,YAAM,MAAK,KAAL,CAAW,OAAX,CAAmB,OAAnB,CAAN,GAAoC,IAApC,CADgB;KAAN,CAnBO;;AAGjB,UAAK,KAAL,GAAa;AACX,qBAAe,MAAK,QAAL,EAAf;KADF,CAHiB;;GAAnB;;AAPI,kBA8BJ,2BAAS;iBACyC,KAAK,KAAL,CADzC;QACC,yBADD;QACU,6BADV;QACqB,yCADrB;QAEC,gBAAkB,KAAK,KAAL,CAAlB,cAFD;;;AAIP,QAAM,YAAY,GAAZ,CAJC;AAKP,QAAM,aAAa,GAAb,CALC;AAMP,QAAI,QAAQ,QAAQ,CAAR,CANL;AAOP,QAAI,SAAS,QAAQ,CAAR,CAPN;;AASP,QAAI,QAAQ,MAAR,EAAgB;AAClB,UAAI,QAAQ,SAAR,EAAmB;AACrB,kBAAU,YAAY,KAAZ,CADW;AAErB,gBAAQ,SAAR,CAFqB;OAAvB;KADF,MAKO;AACL,UAAI,SAAS,UAAT,EAAqB;AACvB,iBAAS,aAAa,MAAb,CADc;AAEvB,iBAAS,UAAT,CAFuB;OAAzB;KANF;;AAYA,QAAI,WAAW,IAAX;QACA,UAAU,IAAV;QACA,YAAY,IAAZ,CAvBG;;AAyBP,QAAI,QAAQ,OAAR,EAAiB;AACnB,iBACE,uCAAK,WAAU,uBAAV;AACA,gBAAQ,QAAQ,CAAR;AACR,iBAAS,KAAK,YAAL;AACT,gBAAQ,KAAK,MAAL;AACR,aAAK,QAAQ,OAAR;AACL,eAAO,QAAQ,CAAR,EALZ,CADF,CADmB;KAArB;;AAWA,QAAI,CAAC,KAAK,QAAL,EAAD,EAAkB;AACpB,gBAAU,uCAAK,WAAU,sBAAV,EAAiC,KAAK,QAAQ,OAAR,EAA3C,CAAV,CADoB;;AAGpB,UAAI,QAAQ,WAAR,KAAwB,IAAxB,IAAgC,kBAAkB,KAAlB,EAAyB;AAC3D,oBAAY;;YAAK,WAAU,WAAV,EAAL;UAA2B,0CAA3B;UAAiC,0CAAjC;UAAuC,0CAAvC;UAA6C,0CAA7C;UAAmD,0CAAnD;SAAZ,CAD2D;OAA7D;KAHF;;AAQA,QAAM,iBAAiB,gBAAgB,0BAAW,SAAX,EAAsB,eAAtB,CAAhB,GAAyD,SAAzD,CA5ChB;;AA8CP,WACE;;QAAK,WAAW,cAAX,EAA2B,OAAO,EAAC,YAAD,EAAQ,cAAR,EAAP,EAAhC;MACG,OADH;MAEG,QAFH;MAGG,SAHH;MAIE,uCAAK,yBAAyB,EAAC,QAAQ,sEAAR,EAA1B,EAAL,CAJF;KADF,CA9CO;;;SA9BL;;;MACG,YAAY;AACjB,WAAS,iBAAU,MAAV,CAAiB,UAAjB;AACT,aAAW,iBAAU,MAAV;AACX,mBAAiB,iBAAU,MAAV;;kBAmFN","file":"Photo.react.js","sourcesContent":["/*\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\n */\n\nimport React, { Component, PropTypes } from 'react';\nimport classnames from 'classnames';\n\nimport { lightbox } from '../../../utils/ImageUtils';\n\nlet cache = [];\n\n/**\n * Class that represents a component for display photo message content\n * @todo move cache to store;\n */\nclass Photo extends Component {\n  static propTypes = {\n    content: PropTypes.object.isRequired,\n    className: PropTypes.string,\n    loadedClassName: PropTypes.string\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      isImageLoaded: this.isCached()\n    };\n  }\n\n  openLightBox = () => lightbox.open(this.props.content.fileUrl, 'message');\n\n  onLoad = () => {\n    this.setCached();\n    if (!this.state.isImageLoaded) {\n      this.setState({isImageLoaded: true});\n    }\n  };\n\n  isCached = () => cache[this.props.content.fileUrl] === true;\n\n  setCached = () => {\n    cache[this.props.content.fileUrl] = true;\n  };\n\n  render() {\n    const { content, className, loadedClassName } = this.props;\n    const { isImageLoaded } = this.state;\n\n    const MAX_WIDTH = 300;\n    const MAX_HEIGHT = 400;\n    let width = content.w;\n    let height = content.h;\n\n    if (width > height) {\n      if (width > MAX_WIDTH) {\n        height *= MAX_WIDTH / width;\n        width = MAX_WIDTH;\n      }\n    } else {\n      if (height > MAX_HEIGHT) {\n        width *= MAX_HEIGHT / height;\n        height = MAX_HEIGHT;\n      }\n    }\n\n    let original = null,\n        preview = null,\n        preloader = null;\n\n    if (content.fileUrl) {\n      original = (\n        <img className=\"photo photo--original\"\n             height={content.h}\n             onClick={this.openLightBox}\n             onLoad={this.onLoad}\n             src={content.fileUrl}\n             width={content.w}/>\n      );\n    }\n\n    if (!this.isCached()) {\n      preview = <img className=\"photo photo--preview\" src={content.preview}/>;\n\n      if (content.isUploading === true || isImageLoaded === false) {\n        preloader = <div className=\"preloader\"><div/><div/><div/><div/><div/></div>;\n      }\n    }\n\n    const imageClassName = isImageLoaded ? classnames(className, loadedClassName) : className;\n\n    return (\n      <div className={imageClassName} style={{width, height}}>\n        {preview}\n        {original}\n        {preloader}\n        <svg dangerouslySetInnerHTML={{__html: '<filter id=\"blur-effect\"><feGaussianBlur stdDeviation=\"3\"/></filter>'}}/>\n      </div>\n    );\n  }\n}\n\nexport default Photo;\n"]}