{"version":3,"sources":["../../../src/components/modals/InviteUser.react.js"],"names":[],"mappings":"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","file":"InviteUser.react.js","sourcesContent":["/*\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\n */\n\nimport { find, assign, forEach } from 'lodash';\n\nimport React, { Component, PropTypes } from 'react';\nimport Modal from 'react-modal';\n\nimport { KeyCodes } from '../../constants/ActorAppConstants';\n\nimport InviteUserActions from '../../actions/InviteUserActions';\nimport InviteUserByLinkActions from '../../actions/InviteUserByLinkActions';\n\nimport ContactStore from '../../stores/PeopleStore';\nimport InviteUserStore from '../../stores/InviteUserStore';\n\nimport ContactItem from './invite-user/ContactItem.react';\n\nconst getStateFromStores = () => {\n  return ({\n    isOpen: InviteUserStore.isModalOpen(),\n    contacts: ContactStore.getList(),\n    group: InviteUserStore.getGroup()\n  });\n};\n\nconst hasMember = (group, userId) =>\n  undefined !== find(group.members, (c) => c.peerInfo.peer.id === userId);\n\nclass InviteUser extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = assign({\n      search: ''\n    }, getStateFromStores());\n\n    InviteUserStore.addChangeListener(this.onChange);\n    ContactStore.addListener(this.onChange);\n  }\n\n  static contextTypes = {\n    intl: PropTypes.object\n  };\n\n  componentWillUnmount() {\n    InviteUserStore.removeChangeListener(this.onChange);\n  }\n\n  componentWillUpdate(nextProps, nextState) {\n    if (nextState.isOpen && !this.state.isOpen) {\n      document.addEventListener('keydown', this.onKeyDown, false);\n    } else if (!nextState.isOpen && this.state.isOpen) {\n      document.removeEventListener('keydown', this.onKeyDown, false);\n    }\n  }\n\n  onChange = () => this.setState(getStateFromStores());\n  onClose = () => InviteUserActions.hide();\n  onContactSelect = (contact) => InviteUserActions.inviteUser(this.state.group.id, contact.uid);\n  onSearchChange = (event) => this.setState({search: event.target.value});\n\n  onInviteUrlByClick = () => {\n    const { group } = this.state;\n\n    InviteUserByLinkActions.show(group);\n    InviteUserActions.hide();\n  };\n\n  onKeyDown = (event) => {\n    if (event.keyCode === KeyCodes.ESC) {\n      event.preventDefault();\n      this.onClose();\n    }\n  };\n\n  render() {\n    const { contacts, group, search, isOpen } = this.state;\n    const { intl } = this.context;\n\n    let contactList = [];\n\n    if (isOpen) {\n\n      forEach(contacts, (contact, i) => {\n        const name = contact.name.toLowerCase();\n        if (name.includes(search.toLowerCase())) {\n          if (!hasMember(group, contact.uid)) {\n            contactList.push(\n              <ContactItem contact={contact} key={i} onSelect={this.onContactSelect}/>\n            );\n          } else {\n            contactList.push(\n              <ContactItem contact={contact} key={i} isMember/>\n            );\n          }\n        }\n      }, this);\n\n      if (contactList.length === 0) {\n        contactList.push(\n          <li className=\"contacts__list__item contacts__list__item--empty text-center\">\n            {intl.messages['inviteModalNotFound']}\n          </li>\n        );\n      }\n      const modalStyle = {\n        content : {\n          position: null,\n          top: null,\n          left: null,\n          right: null,\n          bottom: null,\n          border: null,\n          background: null,\n          overflow: null,\n          outline: null,\n          padding: null,\n          borderRadius: null,\n          width: 440\n        }\n      };\n\n      return (\n        <Modal className=\"modal-new modal-new--invite contacts\"\n               closeTimeoutMS={150}\n               isOpen={isOpen}\n               style={modalStyle}>\n\n          <header className=\"modal-new__header\">\n            <a className=\"modal-new__header__icon material-icons\">person_add</a>\n            <h3 className=\"modal-new__header__title\">{intl.messages['inviteModalTitle']}</h3>\n\n            <div className=\"pull-right\">\n              <button className=\"button button--lightblue\" onClick={this.onClose}>{intl.messages['button.done']}</button>\n            </div>\n          </header>\n\n          <div className=\"modal-new__body\">\n            <div className=\"modal-new__search\">\n              <i className=\"material-icons\">search</i>\n              <input className=\"input input--search\"\n                     onChange={this.onSearchChange}\n                     placeholder={intl.messages['inviteModalSearch']}\n                     type=\"search\"\n                     value={search}/>\n            </div>\n\n            <a className=\"link link--blue\" onClick={this.onInviteUrlByClick}>\n              <i className=\"material-icons\">link</i>\n              {intl.messages['inviteByLink']}\n            </a>\n          </div>\n\n          <div className=\"contacts__body\">\n            <ul className=\"contacts__list\">\n              {contactList}\n            </ul>\n          </div>\n\n        </Modal>\n      );\n    } else {\n      return null;\n    }\n  }\n}\n\nexport default InviteUser;\n"]}