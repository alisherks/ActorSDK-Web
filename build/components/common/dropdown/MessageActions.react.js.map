{"version":3,"sources":["../../../../src/components/common/dropdown/MessageActions.react.js"],"names":[],"mappings":"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","file":"MessageActions.react.js","sourcesContent":["/*\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\n */\n\nimport React, { Component, PropTypes } from 'react';\nimport { findDOMNode } from 'react-dom';\nimport ReactMixin from 'react-mixin';\nimport PureRenderMixin from 'react-addons-pure-render-mixin';\nimport isInside from '../../../utils/isInside';\n\nimport { MessageContentTypes } from '../../../constants/ActorAppConstants';\n\nimport MessageActionCreators from '../../../actions/MessageActionCreators';\nimport ComposeActionCreators from '../../../actions/ComposeActionCreators';\nimport DropdownActionCreators from '../../../actions/DropdownActionCreators';\n\nimport UserStore from '../../../stores/UserStore';\n\nclass MessageActions extends Component {\n  static propTypes = {\n    peer: PropTypes.object.isRequired,\n    message: PropTypes.object.isRequired,\n    targetRect: PropTypes.object.isRequired,\n    hideOnScroll: PropTypes.bool.isRequired\n  };\n\n  static contextTypes = {\n    intl: PropTypes.object\n  };\n\n  constructor(props) {\n    super(props);\n    document.addEventListener('click', this.handleDocumentClick, true);\n\n    if (props.hideOnScroll) {\n      document.addEventListener('scroll', this.handleDropdownClose, true);\n    }\n  }\n\n  componentWillUnmount() {\n    const { hideOnScroll } = this.props;\n    document.removeEventListener('click', this.handleDocumentClick, true);\n\n    if (hideOnScroll) {\n      document.removeEventListener('scroll', this.handleDropdownClose, true);\n    }\n  }\n\n  handleDocumentClick = (event) => {\n    const dropdown = findDOMNode(this.refs.dropdown);\n    const dropdownRect = dropdown.getBoundingClientRect();\n    const coords = {\n      x: event.pageX || event.clientX,\n      y: event.pageY || event.clientY\n    };\n\n    if (!isInside(coords, dropdownRect)) {\n      event.preventDefault();\n      this.handleDropdownClose();\n    }\n  };\n\n\n  handleDropdownClose = () => DropdownActionCreators.hideMessageDropdown();\n\n  handleDelete = () => {\n    const { peer, message } = this.props;\n    MessageActionCreators.deleteMessage(peer, message.rid);\n    this.handleDropdownClose();\n  };\n\n  handleReply = () => {\n    const { message } = this.props;\n    const info = UserStore.getUser(message.sender.peer.id);\n    const replyText = info.nick ? `@${info.nick}: ` : `${info.name}: `;\n    ComposeActionCreators.pasteText(replyText);\n    this.handleDropdownClose();\n  };\n\n  handleQuote = () => {\n    const { message } = this.props;\n    ComposeActionCreators.pasteText(`> ${message.content.text} \\n`);\n    this.handleDropdownClose();\n  };\n\n  render() {\n    const { message, targetRect } = this.props;\n    const { intl } = this.context;\n\n    const isThisMyMessage = UserStore.getMyId() === message.sender.peer.id;\n\n    const dropdownStyles = {\n      top: targetRect.top,\n      left: targetRect.left\n    };\n\n    const dropdownMenuStyles = {\n      minWidth: 120,\n      right: 2,\n      top: -4\n    };\n\n    return (\n      <div className=\"dropdown dropdown--opened dropdown--small\" style={dropdownStyles}>\n        <ul className=\"dropdown__menu dropdown__menu--right\" ref=\"dropdown\" style={dropdownMenuStyles}>\n          <li className=\"dropdown__menu__item hide\">\n            <i className=\"icon material-icons\">star_rate</i> {intl.messages['message.pin']}\n          </li>\n          {\n            !isThisMyMessage\n              ? <li className=\"dropdown__menu__item\" onClick={this.handleReply}>\n                  <i className=\"icon material-icons\">reply</i> {intl.messages['message.reply']}\n                </li>\n              : null\n          }\n          {\n            message.content.content === MessageContentTypes.TEXT\n              ? <li className=\"dropdown__menu__item\" onClick={this.handleQuote}>\n                  <i className=\"icon material-icons\">format_quote</i> {intl.messages['message.quote']}\n                </li>\n              : null\n          }\n          <li className=\"dropdown__menu__item hide\">\n            <i className=\"icon material-icons\">forward</i> {intl.messages['message.forward']}\n          </li>\n          <li className=\"dropdown__menu__item\" onClick={this.handleDelete}>\n            <i className=\"icon material-icons\">delete</i> {intl.messages['message.delete']}\n          </li>\n        </ul>\n      </div>\n    );\n  }\n}\n\nReactMixin.onClass(MessageActions, PureRenderMixin);\n\nexport default MessageActions;\n"]}