{"version":3,"sources":["../../../src/components/common/VoiceRecorder.react.js"],"names":[],"mappings":";;;;AAIA;;;;AACA;;;;AACA;;;;;;;;;;;;;;AAEA,IAAI,uBAAuB,uBAAS,oBAAT,KAAkC,IAAlC,GAAyC,KAAzC;AAC3B,QAAQ,KAAR,CAAc,sBAAd,EAAsC,oBAAtC;;IAEM;;;AAKJ,WALI,aAKJ,CAAY,KAAZ,EAAmB;0BALf,eAKe;;iDACjB,sBAAM,KAAN,GADiB;;UAenB,oBAAoB,YAAM;AACxB,YAAK,QAAL,CAAc,UAAd,GADwB;KAAN,CAfD;;UAmBnB,mBAAmB,YAAM;AACvB,YAAK,QAAL,CAAc,IAAd,GADuB;AAEvB,YAAK,QAAL,CAAc,EAAC,aAAa,KAAb,EAAf,EAFuB;KAAN,CAnBA;;UAwBnB,mBAAmB,UAAC,KAAD,EAAW;UACpB,WAAa,MAAK,KAAL,CAAb,SADoB;UAEpB,WAAa,MAAK,KAAL,CAAb,SAFoB;;;AAI5B,kBAAY,SAAS,WAAW,IAAX,EAAiB,MAAM,MAAN,CAAtC;AAJ4B,KAAX,CAxBA;;UA+BnB,oBAAoB,YAAM;AACxB,YAAK,QAAL,CAAc,KAAd,GADwB;AAExB,YAAK,QAAL,CAAc,EAAC,aAAa,IAAb,EAAf,EAFwB;KAAN,CA/BD;;UAoCnB,uBAAuB,UAAC,KAAD;aAAW,MAAK,QAAL,CAAc,EAAC,UAAU,MAAM,MAAN,CAAa,OAAb,CAAqB,CAArB,CAAV,EAAf;KAAX,CApCJ;;AAGjB,UAAK,KAAL,GAAa;AACX,mBAAa,KAAb;KADF,CAHiB;;AAOjB,QAAI,oBAAJ,EAA0B;AACxB,YAAK,QAAL,GAAgB,4BAAhB,CADwB;AAExB,YAAK,QAAL,CAAc,gBAAd,CAA+B,UAA/B,EAA2C,MAAK,oBAAL,CAA3C,CAFwB;AAGxB,YAAK,QAAL,CAAc,gBAAd,CAA+B,aAA/B,EAA8C,MAAK,iBAAL,CAA9C,CAHwB;AAIxB,YAAK,QAAL,CAAc,gBAAd,CAA+B,eAA/B,EAAgD,MAAK,gBAAL,CAAhD,CAJwB;KAA1B;iBAPiB;GAAnB;;AALI,0BA2CJ,2BAAS;AACP,QAAI,oBAAJ,EAA0B;mBACQ,KAAK,KAAL,CADR;UACjB,iCADiB;UACJ,2BADI;;;AAGxB,UAAM,yBAAyB,0BAAW,gBAAX,EAA6B;AAC1D,qCAA6B,WAA7B;OAD6B,CAAzB,CAHkB;;AAOxB,aACE;;UAAK,WAAW,sBAAX,EAAL;QACE;;YAAG,WAAU,qBAAV;AACA,yBAAa,KAAK,iBAAL;AACb,uBAAW,KAAK,gBAAL,EAFd;;SADF;QAIE;;YAAK,WAAU,UAAV,EAAL;UACE;;cAAK,WAAU,8BAAV,EAAL;;YACiC,QADjC;WADF;SAJF;OADF,CAPwB;KAA1B,MAmBO;AACL,aAAO,IAAP,CADK;KAnBP;;;SA5CE;;;cACG,YAAY;AACjB,YAAU,iBAAU,IAAV,CAAe,UAAf;;kBAmEC","file":"VoiceRecorder.react.js","sourcesContent":["/*\n * Copyright (C) 2015 Actor LLC. <https://actor.im>\n */\n\nimport React, { Component, PropTypes } from 'react';\nimport classnames from 'classnames';\nimport Recorder from 'opus-recorder';\n\nlet isRecordingSupported = Recorder.isRecordingSupported() ? true : false;\nconsole.debug('isRecordingSupported', isRecordingSupported);\n\nclass VoiceRecorder extends Component {\n  static propTypes = {\n    onFinish: PropTypes.func.isRequired\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      isRecording: false\n    };\n\n    if (isRecordingSupported) {\n      this.recorder = new Recorder();\n      this.recorder.addEventListener('duration', this.handleChangeDuration);\n      this.recorder.addEventListener('streamReady', this.handleStreamReady);\n      this.recorder.addEventListener('dataAvailable', this.handleSendRecord);\n    }\n  }\n\n  handleStartRecord = () => {\n    this.recorder.initStream();\n  };\n\n  handleStopRecord = () => {\n    this.recorder.stop();\n    this.setState({isRecording: false});\n  };\n\n  handleSendRecord = (event) => {\n    const { onFinish } = this.props;\n    const { duration } = this.state;\n\n    onFinish && onFinish(duration * 1000, event.detail); //Duration must be in ms\n  };\n\n  handleStreamReady = () => {\n    this.recorder.start();\n    this.setState({isRecording: true});\n  };\n\n  handleChangeDuration = (event) => this.setState({duration: event.detail.toFixed(2)});\n\n  render() {\n    if (isRecordingSupported) {\n      const {isRecording, duration} = this.state;\n\n      const voiceRecorderClassName = classnames('voice-recorder', {\n        'voice-recorder--recording': isRecording\n      });\n\n      return (\n        <div className={voiceRecorderClassName}>\n          <i className=\"material-icons icon\"\n             onMouseDown={this.handleStartRecord}\n             onMouseUp={this.handleStopRecord}>mic</i>\n          <div className=\"duration\">\n            <div className=\"fill row middle-xs center-xs\">\n              Voice message duration:&nbsp; {duration}\n            </div>\n          </div>\n        </div>\n      );\n    } else {\n      return null;\n    }\n  }\n}\n\nexport default VoiceRecorder;\n"]}