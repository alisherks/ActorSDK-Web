{"version":3,"sources":["../../src/components/Login.react.js"],"names":[],"mappings":"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","file":"Login.react.js","sourcesContent":["/*\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\n */\n\nimport React, { Component, PropTypes } from 'react';\nimport { Container } from 'flux/utils';\nimport classnames from 'classnames';\nimport SharedContainer from '../utils/SharedContainer';\nimport { appName, AuthSteps } from '../constants/ActorAppConstants';\nimport { FormattedMessage, FormattedHTMLMessage } from 'react-intl';\n\nimport LoginActionCreators from '../actions/LoginActionCreators';\n\nimport LoginStore from '../stores/LoginStore';\n\nimport TextField from './common/TextField.react';\n\nclass Login extends Component {\n  constructor(props) {\n    super(props);\n\n    const SharedActor = SharedContainer.get();\n    this.appName = SharedActor.appName ? SharedActor.appName : appName;\n  }\n\n  static getStores = () => [LoginStore];\n\n  static calculateState() {\n    return {\n      login: LoginStore.getLogin(),\n      code: LoginStore.getCode(),\n      name: LoginStore.getName(),\n      step: LoginStore.getStep(),\n      errors: LoginStore.getErrors(),\n      isCodeRequested: LoginStore.isCodeRequested(),\n      isCodeSended: LoginStore.isCodeSended(),\n      isSignupStarted: LoginStore.isSignupStarted()\n    }\n  };\n\n  static contextTypes = {\n    intl: PropTypes.object\n  };\n\n  componentDidMount() {\n    this.handleFocus();\n  }\n\n  componentDidUpdate() {\n    this.handleFocus();\n  }\n\n  // From change handlers\n  onLoginChange = event => {\n    event.preventDefault();\n    LoginActionCreators.changeLogin(event.target.value);\n  };\n  onCodeChange = event => {\n    event.preventDefault();\n    LoginActionCreators.changeCode(event.target.value);\n  };\n  onNameChange = event => {\n    event.preventDefault();\n    LoginActionCreators.changeName(event.target.value);\n  };\n\n  // Form submit handlers\n  onRequestCode = event => {\n    event.preventDefault();\n    LoginActionCreators.requestCode(this.state.login);\n  };\n  onSendCode = event => {\n    event.preventDefault();\n    LoginActionCreators.sendCode(this.state.code);\n  };\n  onSignupRequested = event => {\n    event.preventDefault();\n    LoginActionCreators.sendSignup(this.state.name);\n  };\n\n  handleRestartAuthClick = event => {\n    event.preventDefault();\n    LoginActionCreators.restartAuth();\n  };\n\n  handleFocus = () => {\n    const { step } = this.state;\n\n    switch (step) {\n      case AuthSteps.LOGIN_WAIT:\n        this.refs.login.focus();\n        break;\n      case AuthSteps.CODE_WAIT:\n        this.refs.code.focus();\n        break;\n      case AuthSteps.NAME_WAIT:\n        this.refs.name.focus();\n        break;\n      default:\n    }\n  };\n\n  render() {\n    const { step, errors, login, code, name, isCodeRequested, isCodeSended, isSignupStarted } = this.state;\n    const { intl } = this.context;\n\n    let requestFormClassName = classnames('login-new__forms__form', 'login-new__forms__form--request', {\n      'login-new__forms__form--active': step === AuthSteps.LOGIN_WAIT,\n      'login-new__forms__form--done': step !== AuthSteps.LOGIN_WAIT && isCodeRequested\n    });\n    let checkFormClassName = classnames('login-new__forms__form', 'login-new__forms__form--check', {\n      'login-new__forms__form--active': step === AuthSteps.CODE_WAIT && isCodeRequested,\n      'login-new__forms__form--done': step !== AuthSteps.CODE_WAIT && isCodeSended\n    });\n    let signupFormClassName = classnames('login-new__forms__form', 'login-new__forms__form--signup', {\n      'login-new__forms__form--active': step === AuthSteps.NAME_WAIT\n    });\n\n    const spinner = (\n      <div className=\"spinner\">\n        <div/><div/><div/><div/><div/><div/>\n        <div/><div/><div/><div/><div/><div/>\n      </div>\n    );\n\n    return (\n      <section className=\"login-new row center-xs middle-xs\">\n        <div className=\"login-new__welcome col-xs row center-xs middle-xs\">\n          <img alt={`${this.appName} messenger`}\n               className=\"logo\"\n               src=\"assets/images/logo.png\"\n               srcSet=\"assets/images/logo@2x.png 2x\"/>\n\n          <article>\n            <h1 className=\"login-new__heading\">\n              <FormattedHTMLMessage id=\"login.welcome.header\" values={{appName: this.appName}}/>\n            </h1>\n\n            <FormattedHTMLMessage id=\"login.welcome.text\" values={{appName: this.appName}}/>\n          </article>\n\n          <footer>\n            <div className=\"pull-left\"><FormattedMessage id=\"login.welcome.copyright\" values={{appName: this.appName}}/></div>\n            <div className=\"pull-right\">\n              <a href=\"//actorapp.ghost.io/desktop-apps\">Desktop</a>&nbsp;&nbsp;•&nbsp;&nbsp;\n              <a href=\"//actor.im/ios\">iPhone</a>&nbsp;&nbsp;•&nbsp;&nbsp;\n              <a href=\"//actor.im/android\">Android</a>\n            </div>\n          </footer>\n        </div>\n\n        <div className=\"login-new__forms col-xs-6 col-md-4 row center-xs middle-xs\">\n          <div>\n            <h1 className=\"login-new__heading\"><FormattedMessage id=\"login.signIn\"/></h1>\n\n            <form className={requestFormClassName} onSubmit={this.onRequestCode}>\n              <a className=\"wrong\" onClick={this.handleRestartAuthClick}><FormattedMessage id=\"login.wrong\"/></a>\n              <TextField className=\"login-new__forms__form__input input__material--wide\"\n                         disabled={isCodeRequested || step !== AuthSteps.LOGIN_WAIT}\n                         errorText={errors.login}\n                         floatingLabel={intl.messages['login.phone_or_email']}\n                         onChange={this.onLoginChange}\n                         ref=\"login\"\n                         value={login}/>\n              <footer className=\"text-center\">\n                <button className=\"button button--rised button--wide\"\n                        type=\"submit\"\n                        disabled={isCodeRequested}>\n                  <FormattedMessage id=\"button.requestCode\"/>\n                  {isCodeRequested ? spinner : null}\n                </button>\n              </footer>\n            </form>\n\n            <form className={checkFormClassName} onSubmit={this.onSendCode}>\n              <TextField className=\"login-new__forms__form__input input__material--wide\"\n                         disabled={isCodeSended || step !== AuthSteps.CODE_WAIT}\n                         errorText={errors.code}\n                         floatingLabel={intl.messages['login.authCode']}\n                         onChange={this.onCodeChange}\n                         ref=\"code\"\n                         type=\"text\"\n                         value={code}/>\n              <footer className=\"text-center\">\n                <button className=\"button button--rised button--wide\"\n                        type=\"submit\"\n                        disabled={isCodeSended}>\n                  <FormattedMessage id=\"button.checkCode\"/>\n                  {isCodeSended ? spinner : null}\n                </button>\n              </footer>\n            </form>\n\n            <form className={signupFormClassName} onSubmit={this.onSignupRequested}>\n              <TextField className=\"login-new__forms__form__input input__material--wide\"\n                         disabled={isSignupStarted || step === AuthSteps.COMPLETED}\n                         errorText={errors.signup}\n                         floatingLabel={intl.messages['login.yourName']}\n                         onChange={this.onNameChange}\n                         ref=\"name\"\n                         type=\"text\"\n                         value={name}/>\n              <footer className=\"text-center\">\n                <button className=\"button button--rised button--wide\"\n                        type=\"submit\"\n                        disabled={isSignupStarted}>\n                  <FormattedMessage id=\"button.signUp\"/>\n                  {isSignupStarted ? spinner : null}\n                </button>\n              </footer>\n            </form>\n          </div>\n        </div>\n      </section>\n    );\n  }\n}\n\nexport default Container.create(Login, {pure: false, withProps: true});\n"]}