{"version":3,"sources":["../../src/utils/confirm.js"],"names":[],"mappings":";;;;;;kBAiFwB;;AA7ExB;;;;AACA;;AACA;;AACA;;;;AACA;;AACA;;AACA;;;;;;;;;;;;;;IAEM;;;AAWJ,WAXI,OAWJ,CAAY,KAAZ,EAAmB;0BAXf,SAWe;;iDACjB,sBAAM,KAAN,GADiB;;UAkDnB,YAAY,UAAC,KAAD,EAAW;AACrB,UAAI,MAAM,OAAN,KAAkB,4BAAS,GAAT,EAAc;AAClC,cAAM,cAAN,GADkC;AAElC,cAAK,MAAL,GAFkC;OAApC;KADU,CAlDO;;AAGjB,UAAK,OAAL,GAAe,IAAI,OAAJ,CAAY,UAAC,OAAD,EAAU,MAAV,EAAqB;AAC9C,YAAK,MAAL,GAAc,MAAd,CAD8C;AAE9C,YAAK,OAAL,GAAe,OAAf,CAF8C;KAArB,CAA3B,CAHiB;;AAQjB,QAAM,cAAc,0BAAgB,GAAhB,EAAd,CARW;AASjB,UAAK,QAAL,GAAgB,uBAAY,YAAY,WAAZ,CAA5B,CATiB;;GAAnB;;AAXI,oBAuBJ,iDAAoB;AAClB,oCAAsB,eAAtB,CAAsC,KAAtC,EADkB;AAElB,+BAAY,KAAK,IAAL,CAAU,OAAV,CAAZ,CAA+B,KAA/B,GAFkB;AAGlB,aAAS,gBAAT,CAA0B,SAA1B,EAAqC,KAAK,SAAL,EAAgB,KAArD,EAHkB;;;AAvBhB,oBA6BJ,uDAAuB;AACrB,oCAAsB,eAAtB,CAAsC,IAAtC,EADqB;AAErB,aAAS,mBAAT,CAA6B,SAA7B,EAAwC,KAAK,SAAL,EAAgB,KAAxD,EAFqB;;;AA7BnB,oBAkCJ,2BAAS;iBACoD,KAAK,KAAL,CADpD;QACC,yBADD;QACU,iCADV;QACuB,+BADvB;QACmC,mCADnC;;;AAGP,WACE;;MAAkB,KAAK,QAAL;MAChB;;UAAK,WAAU,sBAAV,EAAL;QACE;;YAAQ,WAAU,eAAV,EAAR;UACE;;cAAI,WAAU,sBAAV,EAAJ;YAAsC,OAAtC;WADF;SADF;QAKI,cACI;;YAAK,WAAU,aAAV,EAAL;UAA8B,WAA9B;SADJ,GAEI,IAFJ;QAIF;;YAAQ,WAAU,0BAAV,EAAR;UACE;;cAAQ,WAAU,QAAV,EAAmB,SAAS,KAAK,MAAL,EAApC;YACG,cAAc,6DAAkB,IAAG,eAAH,EAAlB,CAAd;WAFL;UAIE;;cAAQ,WAAU,0BAAV,EAAqC,SAAS,KAAK,OAAL,EAAc,KAAI,SAAJ,EAApE;YACG,gBAAe,6DAAkB,IAAG,WAAH,EAAlB,CAAf;WALL;SATF;OADF;KADF,CAHO;;;SAlCL;;;QACG,YAAY;AACjB,WAAS,iBAAU,SAAV,CAAoB,CAC3B,iBAAU,OAAV,CAAkB,iBAAU,IAAV,CADS,EAE3B,iBAAU,IAAV,CAFO,EAGN,UAHM;AAIT,eAAa,iBAAU,MAAV;AACb,cAAY,iBAAU,MAAV;AACZ,gBAAc,iBAAU,MAAV;;AA6DH,SAAS,OAAT,CAAiB,OAAjB,EAAyC;MAAf,gEAAU,kBAAK;;AACtD,MAAI,UAAU,SAAS,aAAT,CAAuB,KAAvB,CAAV,CADkD;AAEtD,UAAQ,SAAR,GAAoB,gBAApB,CAFsD;AAGtD,MAAM,UAAU,SAAS,IAAT,CAAc,WAAd,CAA0B,OAA1B,CAAV,CAHgD;;AAKtD,MAAM,YAAY,sBAAO,0BAAc,OAAd,aAAwB,oBAAY,QAApC,CAAP,EAAsD,OAAtD,CAAZ,CALgD;;AAOtD,WAAS,OAAT,GAAmB;AACjB,0CAAuB,OAAvB,EADiB;AAEjB,eAAW;aAAM,QAAQ,MAAR;KAAN,EAAwB,CAAnC,EAFiB;GAAnB;;;AAPsD,WAatD,CAAU,OAAV,CAAkB,IAAlB,CACE;WAAM;GAAN,EACA;WAAM;GAAN,CAFF,CAbsD;;AAkBtD,SAAO,UAAU,OAAV,CAlB+C;CAAzC","file":"confirm.js","sourcesContent":["/*\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\n */\n\nimport React, { Component, PropTypes, createElement } from 'react';\nimport { render, findDOMNode, unmountComponentAtNode } from 'react-dom';\nimport { KeyCodes } from '../constants/ActorAppConstants';\nimport ComposeActionCreators from '../actions/ComposeActionCreators';\nimport { IntlProvider, FormattedMessage } from 'react-intl';\nimport { getIntlData } from '../l18n';\nimport SharedContainer from '../utils/SharedContainer';\n\nclass Confirm extends Component {\n  static propTypes = {\n    message: PropTypes.oneOfType([\n      PropTypes.arrayOf(PropTypes.node),\n      PropTypes.node\n    ]).isRequired,\n    description: PropTypes.string,\n    abortLabel: PropTypes.string,\n    confirmLabel: PropTypes.string\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.promise = new Promise((resolve, reject) => {\n      this.reject = reject;\n      this.resolve = resolve;\n    });\n\n    const SharedActor = SharedContainer.get();\n    this.intlData = getIntlData(SharedActor.forceLocale);\n  }\n\n  componentDidMount() {\n    ComposeActionCreators.toggleAutoFocus(false);\n    findDOMNode(this.refs.confirm).focus();\n    document.addEventListener('keydown', this.onKeyDown, false);\n  }\n\n  componentWillUnmount() {\n    ComposeActionCreators.toggleAutoFocus(true);\n    document.removeEventListener('keydown', this.onKeyDown, false);\n  }\n\n  render() {\n    const { message, description, abortLabel, confirmLabel } = this.props;\n\n    return (\n      <IntlProvider {...this.intlData}>\n        <div className=\"modal modal--confirm\">\n          <header className=\"modal__header\">\n            <h4 className=\"modal__header__title\">{message}</h4>\n          </header>\n          {\n            description\n              ? <div className=\"modal__body\">{description}</div>\n              : null\n          }\n          <footer className=\"modal__footer text-right\">\n            <button className=\"button\" onClick={this.reject}>\n              {abortLabel || <FormattedMessage id=\"button.cancel\"/>}\n            </button>\n            <button className=\"button button--lightblue\" onClick={this.resolve} ref=\"confirm\">\n              {confirmLabel ||<FormattedMessage id=\"button.ok\"/>}\n            </button>\n          </footer>\n        </div>\n      </IntlProvider>\n    );\n  }\n\n  onKeyDown = (event) => {\n    if (event.keyCode === KeyCodes.ESC) {\n      event.preventDefault();\n      this.reject();\n    }\n  };\n}\n\nexport default function confirm(message, options = {})  {\n  let element = document.createElement('div');\n  element.className = 'modal-backdrop';\n  const wrapper = document.body.appendChild(element);\n\n  const component = render(createElement(Confirm, {message, ...options}), wrapper);\n\n  function cleanup() {\n    unmountComponentAtNode(wrapper);\n    setTimeout(() => wrapper.remove(), 0);\n  }\n\n  // Unmount component and remove it from DOM\n  component.promise.then(\n    () => cleanup(),\n    () => cleanup()\n  );\n\n  return component.promise;\n}\n"]}